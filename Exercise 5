# what is the value after which we should stop offering discount?
df_avgprof = df.select("Profit","Discount").groupBy("Discount").agg(F.mean("Profit")).orderBy("Discount", ascending = True)
df_avgprof.filter(df_avgprof["avg(Profit)"] <= 0).agg(F.min("Discount")).show()
